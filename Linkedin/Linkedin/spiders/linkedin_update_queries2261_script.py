from linkedin_voyager_functions import *
import csv
import sys
reload(sys)
sys.setdefaultencoding('utf-8')
from  dict_ids import dics
from dict_ids_new import dics_new
class Companysurl(object):
	def __init__(self, *args, **kwargs):
		self.con, self.cur = get_mysql_connection(DB_HOST, 'FACEBOOK', '')
		#self.qu1 = 'select meta_data from linkedin_crawltable where url = "%s"'

	def main(self):
		recs = fetchall(self.cur, "select * from linkedin_voyager_profiles1")
		file("no_ids_for_profiles.txt","ab+").write("%s\n" % 'no ids for these profiles')
		for rec in recs:
			#recsid = fetchmany(self.cur, self.qu1 % rec[7].strip('/'))
			id_given = dics.get(rec[12], '')
			#print 'id_checking', rec[12]
			another_check = ''
			if not id_given:
				id_given = dics_new.get(rec[12], '')
				another_check = 'yes'
			if not id_given:
				file("no_idsnew_for_profiles.txt","ab+").write("%s\n" % rec[7])
			if id_given and another_check == 'yes':
				print id_given
				#m_id = "%s%s" % (rec[12],'.0')
				m_id = id_given
				variable = "update pm_csv1 set Lnkd_status_of_url='%s', Lnkd_data_available_flag='%s', Lnkd_profile_url='%s', Lnkd_name='%s', Lnkd_first_name='%s', Lnkd_last_name='%s', Lnkd_headline='%s', Lnkd_no_of_followers='%s', Lnkd_summary='%s', Lnkd_number_of_connections='%s', Lnkd_industry='%s', Lnkd_location='%s', Lnkd_Accomplishments_languages='%s', Lnkd_emails='%s', Lnkd_websites='%s', Lnkd_addresses='%s', Lnkd_message_handles='%s', Lnkd_phone_numbers='%s', Lnkd_twitter_accounts='%s', Lnkd_profile_image='%s', Lnkd_interests='%s', Lnkd_linkedin_certifications='%s', Lnkd_linkedin_following_channels='%s', Lnkd_linkedin_following_companies='%s', Lnkd_linkedin_following_influencers='%s', Lnkd_linkedin_following_schools='%s', Lnkd_linkedin_given_recommendations='%s', Lnkd_linkedin_groups='%s', Lnkd_Accomplishments_projects='%s', Lnkd_linkedin_received_recommendations='%s', Lnkd_linkedin_skills='%s', Lnkd_linkedin_volunteer_experiences='%s', Lnkd_edu_start_year1='%s', Lnkd_edu_start_month1='%s', Lnkd_edu_start_date1='%s', Lnkd_edu_end_year1='%s', Lnkd_edu_end_date1='%s', Lnkd_edu_end_month1='%s', Lnkd_edu_degree1='%s', Lnkd_edu_field_of_study1='%s', Lnkd_edu_school_name1='%s', Lnkd_school_logo1='%s', Lnkd_edu_start_year2='%s', Lnkd_edu_start_month2='%s', Lnkd_edu_start_date2='%s', Lnkd_edu_end_year2='%s', Lnkd_edu_end_date2='%s', Lnkd_edu_end_month2='%s', Lnkd_edu_degree2='%s', Lnkd_edu_field_of_study2='%s', Lnkd_edu_school_name2='%s', Lnkd_school_logo2='%s', Lnkd_edu_start_year3='%s', Lnkd_edu_start_month3='%s', Lnkd_edu_start_date3='%s', Lnkd_edu_end_year3='%s', Lnkd_edu_end_date3='%s', Lnkd_edu_end_month3='%s', Lnkd_edu_degree3='%s', Lnkd_edu_field_of_study3='%s', Lnkd_edu_school_name3='%s', Lnkd_school_logo3='%s', Lnkd_edu_start_year4='%s', Lnkd_edu_start_month4='%s', Lnkd_edu_start_date4='%s', Lnkd_edu_end_year4='%s', Lnkd_edu_end_date4='%s', Lnkd_edu_end_month4='%s', Lnkd_edu_degree4='%s', Lnkd_edu_field_of_study4='%s', Lnkd_edu_school_name4='%s', Lnkd_school_logo4='%s', Lnkd_edu_start_year5='%s', Lnkd_edu_start_month5='%s', Lnkd_edu_start_date5='%s', Lnkd_edu_end_year5='%s', Lnkd_edu_end_date5='%s', Lnkd_edu_end_month5='%s', Lnkd_edu_degree5='%s', Lnkd_edu_field_of_study5='%s', Lnkd_edu_school_name5='%s', Lnkd_school_logo5='%s', Lnkd_edu_start_year6='%s', Lnkd_edu_start_month6='%s', Lnkd_edu_start_date6='%s', Lnkd_edu_end_year6='%s', Lnkd_edu_end_date6='%s', Lnkd_edu_end_month6='%s', Lnkd_edu_degree6='%s', Lnkd_edu_field_of_study6='%s', Lnkd_edu_school_name6='%s', Lnkd_school_logo6='%s', Lnkd_edu_start_year7='%s', Lnkd_edu_start_month7='%s', Lnkd_edu_start_date7='%s', Lnkd_edu_end_year7='%s', Lnkd_edu_end_date7='%s', Lnkd_edu_end_month7='%s', Lnkd_edu_degree7='%s', Lnkd_edu_field_of_study7='%s', Lnkd_edu_school_name7='%s', Lnkd_school_logo7='%s', Lnkd_exp_location1='%s', Lnkd_exp_company_name1='%s', Lnkd_exp_title1='%s', Lnkd_start_date1='%s', Lnkd_end_date1='%s', Lnkd_exp_company_logo1='%s', Lnkd_exp_duration1='%s', Lnkd_exp_summary1='%s', Lnkd_exp_location2='%s', Lnkd_exp_company_name2='%s', Lnkd_exp_title2='%s', Lnkd_start_date2='%s', Lnkd_end_date2='%s', Lnkd_exp_company_logo2='%s', Lnkd_exp_duration2='%s', Lnkd_exp_summary2='%s', Lnkd_exp_location3='%s', Lnkd_exp_company_name3='%s', Lnkd_exp_title3='%s', Lnkd_start_date3='%s', Lnkd_end_date3='%s', Lnkd_exp_company_logo3='%s', Lnkd_exp_duration3='%s', Lnkd_exp_summary3='%s', Lnkd_exp_location4='%s', Lnkd_exp_company_name4='%s', Lnkd_exp_title4='%s', Lnkd_start_date4='%s', Lnkd_end_date4='%s', Lnkd_exp_company_logo4='%s', Lnkd_exp_duration4='%s', Lnkd_exp_summary4='%s', Lnkd_exp_location5='%s', Lnkd_exp_company_name5='%s', Lnkd_exp_title5='%s', Lnkd_start_date5='%s', Lnkd_end_date5='%s', Lnkd_exp_company_logo5='%s', Lnkd_exp_duration5='%s', Lnkd_exp_summary5='%s', Lnkd_exp_location6='%s', Lnkd_exp_company_name6='%s', Lnkd_exp_title6='%s', Lnkd_start_date6='%s', Lnkd_end_date6='%s', Lnkd_exp_company_logo6='%s', Lnkd_exp_duration6='%s', Lnkd_exp_summary6='%s', Lnkd_exp_location7='%s', Lnkd_exp_company_name7='%s', Lnkd_exp_title7='%s', Lnkd_start_date7='%s', Lnkd_end_date7='%s', Lnkd_exp_company_logo7='%s', Lnkd_exp_duration7='%s', Lnkd_exp_summary7='%s', Lnkd_exp_location8='%s', Lnkd_exp_company_name8='%s', Lnkd_exp_title8='%s', Lnkd_start_date8='%s', Lnkd_end_date8='%s', Lnkd_exp_company_logo8='%s', Lnkd_exp_duration8='%s', Lnkd_exp_summary8='%s', Lnkd_exp_location9='%s', Lnkd_exp_company_name9='%s', Lnkd_exp_title9='%s', Lnkd_start_date9='%s', Lnkd_end_date9='%s', Lnkd_exp_company_logo9='%s', Lnkd_exp_duration9='%s', Lnkd_exp_summary9='%s', Lnkd_exp_location10='%s', Lnkd_exp_company_name10='%s', Lnkd_exp_title10='%s', Lnkd_start_date10='%s', Lnkd_end_date10='%s', Lnkd_exp_company_logo10='%s', Lnkd_exp_duration10='%s', Lnkd_exp_summary10='%s', Lnkd_exp_location11='%s', Lnkd_exp_company_name11='%s', Lnkd_exp_title11='%s', Lnkd_start_date11='%s', Lnkd_end_date11='%s', Lnkd_exp_company_logo11='%s', Lnkd_exp_duration11='%s', Lnkd_exp_summary11='%s', Lnkd_exp_location12='%s', Lnkd_exp_company_name12='%s', Lnkd_exp_title12='%s', Lnkd_start_date12='%s', Lnkd_end_date12='%s', Lnkd_exp_company_logo12='%s', Lnkd_exp_duration12='%s', Lnkd_exp_summary12='%s', Lnkd_exp_location13='%s', Lnkd_exp_company_name13='%s', Lnkd_exp_title13='%s', Lnkd_start_date13='%s', Lnkd_end_date13='%s', Lnkd_exp_company_logo13='%s', Lnkd_exp_duration13='%s', Lnkd_exp_summary13='%s', Lnkd_exp_location14='%s', Lnkd_exp_company_name14='%s', Lnkd_exp_title14='%s', Lnkd_start_date14='%s', Lnkd_end_date14='%s', Lnkd_exp_company_logo14='%s', Lnkd_exp_duration14='%s', Lnkd_exp_summary14='%s', Lnkd_exp_location15='%s', Lnkd_exp_company_name15='%s', Lnkd_exp_title15='%s', Lnkd_start_date15='%s', Lnkd_end_date15='%s', Lnkd_exp_company_logo15='%s', Lnkd_exp_duration15='%s', Lnkd_exp_summary15='%s', Lnkd_honor_on_Date1='%s', Lnkd_honor_issuer1='%s', Lnkd_honor_Description_Summary1='%s', Lnkd_honor_Occupation1='%s', honor_on2='%s', honor_issuer2='%s', honor_summary2='%s', occupation2='%s', honor_on3='%s', honor_issuer3='%s', honor_summary3='%s', occupation3='%s', honor_on4='%s', honor_issuer4='%s', honor_summary4='%s', occupation4='%s', honor_on5='%s', honor_issuer5='%s', honor_summary5='%s', occupation5='%s', Lnkd_created_at='%s', Lnkd_modified_at='%s' where pi_id = '%s'" % (rec[3], MySQLdb.escape_string(rec[4]), MySQLdb.escape_string(rec[7]), MySQLdb.escape_string(rec[9]), MySQLdb.escape_string(rec[10]), MySQLdb.escape_string(rec[11]), MySQLdb.escape_string(rec[13]), MySQLdb.escape_string(rec[14]), MySQLdb.escape_string(rec[16]), MySQLdb.escape_string(rec[17]), MySQLdb.escape_string(rec[18]),MySQLdb.escape_string(rec[19]),MySQLdb.escape_string(rec[20]), MySQLdb.escape_string(rec[21]), MySQLdb.escape_string(rec[22]), MySQLdb.escape_string(rec[23]), MySQLdb.escape_string(rec[24]), MySQLdb.escape_string(rec[25]), MySQLdb.escape_string(rec[29]), MySQLdb.escape_string(rec[30]), MySQLdb.escape_string(rec[31]), MySQLdb.escape_string(rec[36]), MySQLdb.escape_string(rec[38]).encode('utf-8'), MySQLdb.escape_string(rec[39]), MySQLdb.escape_string(rec[40]), MySQLdb.escape_string(rec[41]), MySQLdb.escape_string(rec[42]), MySQLdb.escape_string(rec[43]), MySQLdb.escape_string(rec[46]), MySQLdb.escape_string(rec[47]), MySQLdb.escape_string(rec[48]), MySQLdb.escape_string(rec[49]), MySQLdb.escape_string(rec[52]), MySQLdb.escape_string(rec[53]), MySQLdb.escape_string(rec[54]) , MySQLdb.escape_string(rec[55]), MySQLdb.escape_string(rec[56]), MySQLdb.escape_string(rec[57]), MySQLdb.escape_string(rec[58]), MySQLdb.escape_string(rec[59]), MySQLdb.escape_string(rec[60]), MySQLdb.escape_string(rec[61]), MySQLdb.escape_string(rec[65]), MySQLdb.escape_string(rec[66]), MySQLdb.escape_string(rec[67]), MySQLdb.escape_string(rec[68]), MySQLdb.escape_string(rec[69]),MySQLdb.escape_string(rec[70]),MySQLdb.escape_string(rec[71]),MySQLdb.escape_string(rec[72]), MySQLdb.escape_string(rec[73]),MySQLdb.escape_string(rec[74]),MySQLdb.escape_string(rec[78]), MySQLdb.escape_string(rec[79]), MySQLdb.escape_string(rec[80]), MySQLdb.escape_string(rec[81]), MySQLdb.escape_string(rec[82]), MySQLdb.escape_string(rec[83]), MySQLdb.escape_string(rec[84]), MySQLdb.escape_string(rec[85]), MySQLdb.escape_string(rec[86]), MySQLdb.escape_string(rec[87]),MySQLdb.escape_string(rec[91]), MySQLdb.escape_string(rec[92]), MySQLdb.escape_string(rec[93]), MySQLdb.escape_string(rec[94]), MySQLdb.escape_string(rec[95]), MySQLdb.escape_string(rec[96]), MySQLdb.escape_string(rec[97]), MySQLdb.escape_string(rec[98]), MySQLdb.escape_string(rec[99]), MySQLdb.escape_string(rec[100]),MySQLdb.escape_string(rec[104]), MySQLdb.escape_string(rec[105]), MySQLdb.escape_string(rec[106]), MySQLdb.escape_string(rec[107]), MySQLdb.escape_string(rec[108]), MySQLdb.escape_string(rec[109]),MySQLdb.escape_string(rec[110]), MySQLdb.escape_string(rec[111]), MySQLdb.escape_string(rec[112]), MySQLdb.escape_string(rec[113]), MySQLdb.escape_string(rec[117]), MySQLdb.escape_string(rec[118]), MySQLdb.escape_string(rec[119]), MySQLdb.escape_string(rec[120]), MySQLdb.escape_string(rec[121]), MySQLdb.escape_string(rec[122]), MySQLdb.escape_string(rec[123]), MySQLdb.escape_string(rec[124]), MySQLdb.escape_string(rec[125]), MySQLdb.escape_string(rec[126]), MySQLdb.escape_string(rec[130]), MySQLdb.escape_string(rec[131]), MySQLdb.escape_string(rec[132]), MySQLdb.escape_string(rec[133]), MySQLdb.escape_string(rec[134]), MySQLdb.escape_string(rec[135]), MySQLdb.escape_string(rec[136]), MySQLdb.escape_string(rec[137]), MySQLdb.escape_string(rec[138]), MySQLdb.escape_string(rec[139]), MySQLdb.escape_string(rec[429]), MySQLdb.escape_string(rec[430]), MySQLdb.escape_string(rec[432]), MySQLdb.escape_string(rec[433]), MySQLdb.escape_string(rec[434]), MySQLdb.escape_string(rec[435]), MySQLdb.escape_string(rec[436]), MySQLdb.escape_string(rec[439]), MySQLdb.escape_string(rec[440]), MySQLdb.escape_string(rec[441]), MySQLdb.escape_string(rec[443]), MySQLdb.escape_string(rec[444]), MySQLdb.escape_string(rec[445]), MySQLdb.escape_string(rec[446]), MySQLdb.escape_string(rec[447]), MySQLdb.escape_string(rec[450]),  MySQLdb.escape_string(rec[451]), MySQLdb.escape_string(rec[452]), MySQLdb.escape_string(rec[454]), MySQLdb.escape_string(rec[455]), MySQLdb.escape_string(rec[456]), MySQLdb.escape_string(rec[457]), MySQLdb.escape_string(rec[458]), MySQLdb.escape_string(rec[461]), MySQLdb.escape_string(rec[462]), MySQLdb.escape_string(rec[463]), MySQLdb.escape_string(rec[465]), MySQLdb.escape_string(rec[466]), MySQLdb.escape_string(rec[467]), MySQLdb.escape_string(rec[468]), MySQLdb.escape_string(rec[469]), MySQLdb.escape_string(rec[472]), MySQLdb.escape_string(rec[473]), MySQLdb.escape_string(rec[474]), MySQLdb.escape_string(rec[476]), MySQLdb.escape_string(rec[477]), MySQLdb.escape_string(rec[478]), MySQLdb.escape_string(rec[479]), MySQLdb.escape_string(rec[480]), MySQLdb.escape_string(rec[483]), MySQLdb.escape_string(rec[484]), MySQLdb.escape_string(rec[485]), MySQLdb.escape_string(rec[487]), MySQLdb.escape_string(rec[488]), MySQLdb.escape_string(rec[489]), MySQLdb.escape_string(rec[490]), MySQLdb.escape_string(rec[491]), MySQLdb.escape_string(rec[494]), MySQLdb.escape_string(rec[495]), MySQLdb.escape_string(rec[496]), MySQLdb.escape_string(rec[498]), MySQLdb.escape_string(rec[499]), MySQLdb.escape_string(rec[500]), MySQLdb.escape_string(rec[501]), MySQLdb.escape_string(rec[502]), MySQLdb.escape_string(rec[505]), MySQLdb.escape_string(rec[506]), MySQLdb.escape_string(rec[507]), MySQLdb.escape_string(rec[509]), MySQLdb.escape_string(rec[510]), MySQLdb.escape_string(rec[511]), MySQLdb.escape_string(rec[512]), MySQLdb.escape_string(rec[513]), MySQLdb.escape_string(rec[516]), MySQLdb.escape_string(rec[517]), MySQLdb.escape_string(rec[518]), MySQLdb.escape_string(rec[520]), MySQLdb.escape_string(rec[521]), MySQLdb.escape_string(rec[522]), MySQLdb.escape_string(rec[523]), MySQLdb.escape_string(rec[524]), MySQLdb.escape_string(rec[527]), MySQLdb.escape_string(rec[528]), MySQLdb.escape_string(rec[529]), MySQLdb.escape_string(rec[531]), MySQLdb.escape_string(rec[532]), MySQLdb.escape_string(rec[533]), MySQLdb.escape_string(rec[534]), MySQLdb.escape_string(rec[535]), MySQLdb.escape_string(rec[538]), MySQLdb.escape_string(rec[539]), MySQLdb.escape_string(rec[540]), MySQLdb.escape_string(rec[542]), MySQLdb.escape_string(rec[543]), MySQLdb.escape_string(rec[544]), MySQLdb.escape_string(rec[545]), MySQLdb.escape_string(rec[546]), MySQLdb.escape_string(rec[549]), MySQLdb.escape_string(rec[550]), MySQLdb.escape_string(rec[551]), MySQLdb.escape_string(rec[553]), MySQLdb.escape_string(rec[554]), MySQLdb.escape_string(rec[555]), MySQLdb.escape_string(rec[556]), MySQLdb.escape_string(rec[557]), MySQLdb.escape_string(rec[560]), MySQLdb.escape_string(rec[561]), MySQLdb.escape_string(rec[562]), MySQLdb.escape_string(rec[564]), MySQLdb.escape_string(rec[565]), MySQLdb.escape_string(rec[566]), MySQLdb.escape_string(rec[567]), MySQLdb.escape_string(rec[568]), MySQLdb.escape_string(rec[571]), MySQLdb.escape_string(rec[572]), MySQLdb.escape_string(rec[573]), MySQLdb.escape_string(rec[575]), MySQLdb.escape_string(rec[576]), MySQLdb.escape_string(rec[577]), MySQLdb.escape_string(rec[578]), MySQLdb.escape_string(rec[579]), MySQLdb.escape_string(rec[582]), MySQLdb.escape_string(rec[583]), MySQLdb.escape_string(rec[584]), MySQLdb.escape_string(rec[586]), MySQLdb.escape_string(rec[587]), MySQLdb.escape_string(rec[588]), MySQLdb.escape_string(rec[589]), MySQLdb.escape_string(rec[590]), MySQLdb.escape_string(rec[593]), MySQLdb.escape_string(rec[605]), MySQLdb.escape_string(rec[606]), MySQLdb.escape_string(rec[607]), MySQLdb.escape_string(rec[609]), MySQLdb.escape_string(rec[610]), MySQLdb.escape_string(rec[611]), MySQLdb.escape_string(rec[612]), MySQLdb.escape_string(rec[614]), MySQLdb.escape_string(rec[615]), MySQLdb.escape_string(rec[616]), MySQLdb.escape_string(rec[617]), MySQLdb.escape_string(rec[619]), MySQLdb.escape_string(rec[620]), MySQLdb.escape_string(rec[621]), MySQLdb.escape_string(rec[622]), MySQLdb.escape_string(rec[624]), MySQLdb.escape_string(rec[625]), MySQLdb.escape_string(rec[626]), MySQLdb.escape_string(rec[627]), MySQLdb.escape_string(rec[629]), MySQLdb.escape_string(str(rec[655])), MySQLdb.escape_string(str(rec[656])), m_id)
				file("update_queriesnew_ids.txt","ab+").write("%s\n" %variable)
	
if __name__ == '__main__':
	Companysurl().main()
